<div class="ui col-10 d-flex flex-column justify-content-between bg-white rounded-5" style="margin-left: 8.33%;">
    <div class="row col-12">
        <div class="col-8">
            <div class="row col-12">
                <h1 class="p-4 col-6">{{order?.title}}</h1>

                <h5 class="pt-5 col-6" style="text-align: end;">Created By:</h5>
            </div>
            <div class="row d-flex justify-content-between">
                <h2 class="px-4 col-7">{{order?.price}}$</h2>
                <div class="col-2 bg-secondary rounded-5 text-white p-2" style="text-align: center;">
                    <img style="width: 75px; border-radius: 50%;" [src]="order?.user?.profilePicture">
                    <p class="m-0">{{order?.user?.username}}</p>
                </div>
            </div>
            <hr class="m-3" style="border: black solid 2px;">
        </div>
        <div class="col-4">
            <div class="bg-dark text-white rounded-5 my-2 py-2">
                <div class="row d-flex justify-content-center">
                    <h2 class="col-12" style="text-align: center;">Admin Tools</h2>
                </div>
                <div class="row d-flex justify-content-center">
                    <button class="btn btn-warning col-4 mx-4" style="font-weight: bold;">Edit</button>
                    <button class="btn btn-danger col-4 mx-4" style="font-weight: bold;">Delete</button>
                </div>
            </div>

        </div>
        <div ngbDropdown class="dropdown mx-4">
            <button class="btn dropdown-toggle + {{stateColor}}" id="dropdownBasic1" ngbDropdownToggle>
                {{order?.state}}
            </button>
            <div ngbDropdownMenu aria-labelledby="dropdownBasic1">
                <button ngbDropdownItem (click)="changeState('OPEN')">Open</button>
                <button ngbDropdownItem (click)="changeState('OCCUPIED')">Occupied</button>
                <button ngbDropdownItem (click)="changeState('CLOSED')">Closed</button>
            </div>
        </div>
    </div>
    <p class="m-4">{{order?.createdAt}}</p>
    <div class="col-10 bg-secondary text-white mx-4 mb-4 rounded-3">
        <h2 class="px-4">Description</h2>
        <p class="col-10 px-4">{{order?.description}}</p>
    </div>
    <hr class="m-3" style="border: black solid 2px;">
    <h2 class="px-4">Messages</h2>
    <div class="col-10 bg-secondary text-white mx-4 mb-4 rounded-3">
        @for (message of order?.messages; track $index) {
        <div class="bg-light my-5 mx-2 pb-3 text-black rounded-3">
            <div class="row d-flex justify-content-between">
                <h3 class="mx-2 col-7">{{message.title}}</h3>
                <div class="col-3">
                    <p class="mb-0">{{message.dateTime}}</p>
                    @if (message.author.username == order!.user.username) {
                    <p>by: {{message.author.username}} <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                            fill="currentColor" class="bi bi-award-fill" viewBox="0 0 16 16">
                            <path
                                d="m8 0 1.669.864 1.858.282.842 1.68 1.337 1.32L13.4 6l.306 1.854-1.337 1.32-.842 1.68-1.858.282L8 12l-1.669-.864-1.858-.282-.842-1.68-1.337-1.32L2.6 6l-.306-1.854 1.337-1.32.842-1.68L6.331.864z" />
                            <path d="M4 11.794V16l4-1 4 1v-4.206l-2.018.306L8 13.126 6.018 12.1z" />
                        </svg></p>
                    }
                    @if (message.author.username != order!.user.username) {
                    <p>by: {{message.author.username}}</p>
                    }
                </div>
            </div>
            <p class="mx-2">{{message.message}}</p>
            <div class="d-flex justify-content-end">
                <button class="btn btn-danger col-4 mx-4" style="font-weight: bold;"
                    (click)="deleteMessageModal(deleteMessagem, message.id)">Delete</button>
            </div>
        </div>
        }
    </div>
</div>

<ng-template #deleteMessagem let-modal>
    <div class="modal-header bg-danger">
        <h4 class="modal-title text-white" id="modal-basic-title">Delete Message</h4>
        <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
    </div>
    <div class="modal-body">
        <p>You are about to permanently delete this message, are you sure?</p>
    </div>
    <div class="modal-footer">
        <button type="submit" class="btn btn-outline-dark" (click)="deleteMessage()">Delete for ever</button>
    </div>
</ng-template>